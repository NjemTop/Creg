{% load static %}

<link rel="stylesheet" href="{% static 'css/navbar.css' %}">

<nav class="navbar navbar-expand-lg custom-navbar fixed-top">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <!-- –õ–µ–≤—ã–π –±–ª–æ–∫ -->
        <div class="d-flex align-items-center navbar-left me-auto">
            <a class="navbar-brand d-flex align-items-center" href="{% url 'core:index' %}">
                <img src="{% static 'images/logo128x128.png' %}" alt="Logo" width="30" height="30" class="me-2">
                Creg
            </a>
            {% if request.user.is_authenticated %}
                <a href="{% url 'clients:create_client' %}" class="btn styled-btn btn-create-client ms-3">
                    <i class="bi bi-person-plus"></i> –°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
                </a>
            {% endif %}
        </div>

        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –±–ª–æ–∫ -->
        <div class="d-flex flex-grow-1 navbar-center">
            <!-- –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ -->
            <form class="d-flex search-form position-relative">
                <!-- –ö–Ω–æ–ø–∫–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ (—Å–ª–µ–≤–∞) -->
                <button type="button" class="btn styled-btn search-btn-left" data-bs-toggle="modal" data-bs-target="#searchModal">
                    <i class="bi bi-filter"></i>
                </button>

                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –ø–æ–∏—Å–∫–∞ -->
                <input id="searchInput" class="form-control search-input" type="search" placeholder="–ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤..." aria-label="Search">
            </form>

            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="searchResultsContainer" class="search-results-container">
                <div class="search-results" id="searchResults"></div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤—ã–π –±–ª–æ–∫ -->
        <div class="d-flex align-items-center navbar-right ms-auto me-3">
            <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
            <button id="themeToggle" class="btn btn-outline-dark me-3">
                <i class="bi bi-moon"></i>
            </button>

            <!-- –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è -->
            {% if request.user.is_authenticated %}
                <div class="dropdown">
                    <button class="btn btn-outline-dark dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle"></i> {{ request.user.username }}
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                        {% if request.user.is_staff %}
                            <li>
                                <a class="dropdown-item" href="{% url 'admin:index' %}">
                                    <i class="bi bi-gear"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                        {% endif %}
                        <li>
                            <a class="dropdown-item text-danger" href="{% url 'logout' %}">
                                <i class="bi bi-box-arrow-right"></i> –í—ã–π—Ç–∏
                            </a>
                        </li>
                    </ul>
                </div>
            {% else %}
                <a class="btn styled-btn" href="{% url 'local_login' %}">
                    <i class="bi bi-person-circle"></i> –í—Ö–æ–¥
                </a>
            {% endif %}
        </div>
    </div>
</nav>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="searchModalLabel">üîé –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤</h5>
                <button type="button" class="styled-btn btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="clientName" class="form-label">–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞</label>
                        <input type="text" class="form-control" id="clientName">
                    </div>
                    <button type="submit" class="styled-btn w-100">–ü–æ–∏—Å–∫</button>
                </form>
            </div>
        </div>
    </div>
</div>
